<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Party üéµ</title>
    <link href="https://fonts.googleapis.com/css2?family=Bungee+Shade&family=Montserrat:wght@600;800&display=swap" rel="stylesheet">
</head>
<body>
    <div id="root"></div>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // FIREBASE
        const firebaseConfig = {
            apiKey: "AIzaSyAWA-Zfs_hljCFz1wc0Rg2LJWZPINWONnU",
            authDomain: "quizz-party-ptg.firebaseapp.com",
            databaseURL: "https://quizz-party-ptg-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "quizz-party-ptg",
            storageBucket: "quizz-party-ptg.firebasestorage.app",
            messagingSenderId: "352511986737",
            appId: "1:352511986737:web:7318d807b4d3f3b6b29910"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // DEEZER
        class DeezerAPI {
            constructor() {
                this.proxies = ['', 'https://corsproxy.io/?', 'https://api.codetabs.com/v1/proxy?quest='];
            }
            async fetchWithProxy(url) {
                for (let i = 0; i < this.proxies.length; i++) {
                    try {
                        const finalUrl = this.proxies[i] + encodeURIComponent(url);
                        const res = await fetch(finalUrl);
                        if (!res.ok) throw new Error('Erreur');
                        return await res.json();
                    } catch (e) {
                        if (i === this.proxies.length - 1) throw e;
                    }
                }
            }
            async getChart() {
                const data = await this.fetchWithProxy('https://api.deezer.com/chart/0/tracks?limit=50');
                return data.data.map(t => ({
                    title: t.title,
                    artist: t.artist.name,
                    cover: t.album.cover_big || 'https://via.placeholder.com/400',
                    preview: t.preview
                })).filter(t => t.preview && t.cover);
            }
            async getPlaylist(id) {
                const data = await this.fetchWithProxy(`https://api.deezer.com/playlist/${id}`);
                return data.tracks.data.map(t => ({
                    title: t.title,
                    artist: t.artist.name,
                    cover: t.album.cover_big || 'https://via.placeholder.com/400',
                    preview: t.preview
                })).filter(t => t.preview && t.cover);
            }
        }

        const shuffle = arr => [...arr].sort(() => Math.random() - 0.5);
        const genCode = () => Math.floor(100000 + Math.random() * 900000).toString();

        // MENU
        const Menu = ({ onCreate, onJoin }) => (
            <div className="screen">
                <div className="logo">
                    <h1 className="title">QUIZ PARTY</h1>
                    <p className="subtitle">üéµ Blind Test Musical</p>
                </div>
                <div className="menu-btns">
                    <button className="btn large" onClick={onCreate}>üéÆ Cr√©er</button>
                    <button className="btn large secondary" onClick={onJoin}>üë• Rejoindre</button>
                </div>
            </div>
        );

        // CREATE
        const Create = ({ onStart }) => {
            const [deezer] = useState(new DeezerAPI());
            const [name, setName] = useState('');
            const [playlist, setPlaylist] = useState('');
            const [numQ, setNumQ] = useState(10);
            const [mode, setMode] = useState('qcm');
            const [loading, setLoading] = useState(false);

            const load = async (type) => {
                if (!name) { alert('‚ö†Ô∏è Entre ton pseudo'); return; }
                setLoading(true);
                try {
                    let tracks;
                    if (type === 'chart') {
                        tracks = await deezer.getChart();
                    } else {
                        const match = playlist.match(/playlist\/(\d+)/);
                        if (!match) { alert('‚ùå URL invalide'); return; }
                        tracks = await deezer.getPlaylist(match[1]);
                    }
                    if (tracks.length < numQ) {
                        alert(`‚ö†Ô∏è Seulement ${tracks.length} morceaux disponibles`);
                    }
                    alert(`‚úÖ ${tracks.length} morceaux charg√©s`);
                    onStart(name, mode, numQ, tracks);
                } catch (e) {
                    alert('‚ùå ' + e.message);
                }
                setLoading(false);
            };

            return (
                <div className="screen">
                    <h2 className="screen-title">üéÆ Cr√©er une partie</h2>
                    <input className="input" placeholder="Ton pseudo" value={name} onChange={e => setName(e.target.value)} maxLength={20} />
                    
                    <div className="section">
                        <h3>üéØ Mode</h3>
                        <select className="select" value={mode} onChange={e => setMode(e.target.value)}>
                            <option value="qcm">QCM</option>
                            <option value="writing">√âcriture</option>
                            <option value="soiree">Soir√©e</option>
                        </select>
                    </div>

                    <div className="section">
                        <h3>üî¢ Questions</h3>
                        <div className="num-grid">
                            {[5,10,15,20,30].map(n => (
                                <button key={n} className={`num-btn ${numQ === n ? 'active' : ''}`} onClick={() => setNumQ(n)}>{n}</button>
                            ))}
                        </div>
                    </div>

                    <div className="section">
                        <h3>üéµ Musique</h3>
                        <button className="btn" onClick={() => load('chart')} disabled={loading}>
                            {loading ? '‚è≥' : 'üî•'} Top 50
                        </button>
                        <input className="input" placeholder="URL Playlist Deezer" value={playlist} onChange={e => setPlaylist(e.target.value)} />
                        <button className="btn" onClick={() => load('playlist')} disabled={!playlist || loading}>
                            {loading ? '‚è≥' : 'üìã'} Charger
                        </button>
                    </div>
                </div>
            );
        };

        // JOIN
        const Join = ({ onJoin }) => {
            const [name, setName] = useState('');
            const [code, setCode] = useState('');
            return (
                <div className="screen">
                    <h2 className="screen-title">üë• Rejoindre</h2>
                    <input className="input" placeholder="Ton pseudo" value={name} onChange={e => setName(e.target.value)} maxLength={20} />
                    <input className="input code-input" placeholder="123456" type="tel" value={code} onChange={e => setCode(e.target.value.replace(/\D/g, ''))} maxLength={6} />
                    <button className="btn large" onClick={() => onJoin(name, code)} disabled={!name || code.length !== 6}>‚ñ∂Ô∏è Rejoindre</button>
                </div>
            );
        };

        // LOBBY
        const Lobby = ({ room, isHost, onStart }) => (
            <div className="screen">
                <h2 className="screen-title">Salle d'attente</h2>
                <div className="code-display">
                    <div className="code-label">Code de la partie</div>
                    <div className="code-value">{room.code}</div>
                </div>
                <div className="players-box">
                    <h3>üë• Joueurs ({room.players?.length || 0})</h3>
                    {room.players?.map((p, i) => (
                        <div key={i} className="player">
                            <span className="player-num">{i+1}</span>
                            <span className="player-name">{p.name}</span>
                            {p.name === room.host && <span>üëë</span>}
                        </div>
                    ))}
                </div>
                {isHost && <button className="btn large" onClick={onStart}>‚ñ∂Ô∏è Lancer</button>}
                {!isHost && <div className="waiting"><div className="spinner"></div><p>En attente...</p></div>}
            </div>
        );

        // GAME
        const Game = ({ room, playerIdx, onAnswer, isHost }) => {
            const [time, setTime] = useState(20);
            const [answered, setAnswered] = useState(false);
            const [options, setOptions] = useState([]);
            const [correct, setCorrect] = useState('');
            const [qText, setQText] = useState('');
            const [inputs, setInputs] = useState({ title: '', artist: '' });
            const [result, setResult] = useState(null);

            const audioRef = useRef(null);
            const timerRef = useRef(null);
            
            const q = room.questions?.[room.currentQ];
            const player = room.players?.[playerIdx];
            
            // S√âCURIT√â
            if (!q || !player) {
                return <div className="screen"><h2>Chargement...</h2></div>;
            }

            const blur = answered ? 0 : (time / 20) * 25;

            useEffect(() => {
                setTime(20);
                setAnswered(false);
                setResult(null);
                setInputs({ title: '', artist: '' });

                // AUDIO SEULEMENT POUR L'HOTE
                if (isHost && audioRef.current) {
                    audioRef.current.pause();
                    audioRef.current.currentTime = 0;
                    setTimeout(() => audioRef.current?.play().catch(() => {}), 200);
                }

                if (q.type === 'qcm') {
                    const type = Math.random() > 0.5 ? 'artist' : 'title';
                    const correctAns = q[type];
                    const opts = [correctAns];
                    const allTracks = room.questions || [];
                    const pool = shuffle(allTracks.filter(m => m[type] && m[type] !== correctAns));
                    
                    while (opts.length < 4 && pool.length > 0) {
                        const val = pool.pop()[type];
                        if (val && !opts.includes(val)) opts.push(val);
                    }

                    setOptions(shuffle(opts));
                    setCorrect(correctAns);
                    setQText(type === 'artist' ? "Qui est l'artiste ?" : "Quel est le titre ?");
                }

                timerRef.current = setInterval(() => {
                    setTime(prev => {
                        if (prev <= 1) {
                            clearInterval(timerRef.current);
                            return 0;
                        }
                        return prev - 1;
                    });
                }, 1000);

                return () => {
                    clearInterval(timerRef.current);
                    if (audioRef.current) audioRef.current.pause();
                };
            }, [room.currentQ]);

            const submit = (answer, t = time) => {
                if (answered) return;
                setAnswered(true);
                clearInterval(timerRef.current);
                if (audioRef.current) audioRef.current.pause();

                let isCorrect = false;
                let pts = 0;
                let msg = '';

                if (q.type === 'qcm') {
                    isCorrect = answer === correct;
                    pts = isCorrect ? (50 + t * 10) : 0;
                    msg = isCorrect ? `üéâ +${pts} pts` : `‚ùå ${q.title} - ${q.artist}`;
                } else {
                    const title = inputs.title.toLowerCase().trim();
                    const artist = inputs.artist.toLowerCase().trim();
                    const titleOk = title && q.title.toLowerCase().includes(title.split(' ')[0]);
                    const artistOk = artist && q.artist.toLowerCase().includes(artist.split(' ')[0]);
                    
                    if (titleOk && artistOk) {
                        isCorrect = true;
                        pts = 50 + t * 10;
                        msg = `üéâ +${pts} pts`;
                    } else if (titleOk || artistOk) {
                        pts = Math.floor((50 + t * 10) * 0.5);
                        msg = `üëç +${pts} pts (50%)`;
                    } else {
                        msg = `‚ùå ${q.title} - ${q.artist}`;
                    }
                }

                setResult({ isCorrect, msg });
                setTimeout(() => onAnswer(pts), 2000);
            };

            return (
                <div className="screen game">
                    <div className="game-header">
                        <div className="timer">‚è±Ô∏è {time}s</div>
                        <div>Q {room.currentQ + 1}/{room.questions.length}</div>
                        <div className="score">üèÜ {player.score || 0}</div>
                    </div>

                    <div className="img-box">
                        <img src={q.cover} className="cover" style={{ filter: `blur(${blur}px)` }} />
                    </div>

                    {isHost && (
                        <div className="audio-box">
                            <audio ref={audioRef} src={q.preview} loop />
                            <button className="audio-btn" onClick={() => {
                                if (audioRef.current?.paused) audioRef.current.play();
                                else audioRef.current?.pause();
                            }}>
                                üéµ {answered ? 'Stop' : 'Play'}
                            </button>
                        </div>
                    )}

                    <div className="question-box">
                        {q.type === 'qcm' && (
                            <>
                                <h3 className="q-text">{qText}</h3>
                                <div className="options">
                                    {options.map((opt, i) => (
                                        <button
                                            key={i}
                                            className={`opt ${result ? (opt === correct ? 'correct' : 'wrong') : ''}`}
                                            onClick={() => submit(opt, time)}
                                            disabled={answered}
                                        >
                                            {opt}
                                        </button>
                                    ))}
                                </div>
                            </>
                        )}

                        {q.type === 'writing' && (
                            <>
                                <h3 className="q-text">√âcris le titre et l'artiste</h3>
                                <input className="input" placeholder="Titre" value={inputs.title} onChange={e => setInputs({...inputs, title: e.target.value})} disabled={answered} />
                                <input className="input" placeholder="Artiste" value={inputs.artist} onChange={e => setInputs({...inputs, artist: e.target.value})} disabled={answered} />
                                {!answered && <button className="btn" onClick={() => submit(null, time)}>Valider</button>}
                            </>
                        )}

                        {result && (
                            <div className={`result ${result.isCorrect ? 'correct' : 'wrong'}`}>
                                {result.msg}
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        // LEADERBOARD - GARANTI D'AFFICHER
        const Leaderboard = ({ room, onRestart }) => {
            console.log('üèÜ LEADERBOARD RENDU');
            console.log('Room:', room);
            
            const players = room?.players || [];
            const sorted = [...players].sort((a, b) => (b.score || 0) - (a.score || 0));

            return (
                <div className="screen leaderboard-screen">
                    <h1 className="leaderboard-title">üèÜ CLASSEMENT FINAL üèÜ</h1>
                    
                    {sorted.length > 0 ? (
                        <>
                            <div className="podium">
                                {sorted.slice(0, 3).map((p, i) => (
                                    <div key={i} className="podium-item">
                                        <div className="medal">{['ü•á','ü•à','ü•â'][i]}</div>
                                        <div className="p-name">{p.name || 'Joueur'}</div>
                                        <div className="p-score">{p.score || 0} pts</div>
                                    </div>
                                ))}
                            </div>

                            <div className="leaderboard">
                                {sorted.map((p, i) => (
                                    <div key={i} className="lb-row">
                                        <span className="rank">#{i+1}</span>
                                        <span className="name">{p.name || 'Joueur'}</span>
                                        <span className="pts">{p.score || 0} pts</span>
                                    </div>
                                ))}
                            </div>
                        </>
                    ) : (
                        <div style={{padding: '2rem', color: '#ffbe0b'}}>
                            <h2>Aucun joueur trouv√©</h2>
                            <p>Room: {JSON.stringify(room)}</p>
                        </div>
                    )}

                    <button className="btn large" onClick={onRestart}>üè† Nouvelle partie</button>
                </div>
            );
        };

        // APP
        const App = () => {
            const [screen, setScreen] = useState('menu');
            const [room, setRoom] = useState(null);
            const [playerIdx, setPlayerIdx] = useState(0);
            const [isHost, setIsHost] = useState(false);

            const roomRef = useRef(null);

            useEffect(() => {
                if (room?.code) {
                    const ref = db.ref(`rooms/${room.code}`);
                    roomRef.current = ref;

                    ref.on('value', snapshot => {
                        const data = snapshot.val();
                        if (data) {
                            setRoom(data);
                            
                            if (data.started && screen === 'lobby') {
                                setScreen('game');
                            }
                            
                            // FORCE LEADERBOARD
                            if (data.currentQ >= data.questions.length && screen === 'game') {
                                console.log('üèÅ FIN - PASSAGE AU LEADERBOARD');
                                setScreen('leaderboard');
                            }
                        }
                    });

                    return () => ref.off();
                }
            }, [room?.code, screen]);

            const create = (name, mode, numQ, tracks) => {
                const code = genCode();
                const music = shuffle(tracks);
                let questions;
                
                if (mode === 'soiree') {
                    const half = Math.floor(numQ / 2);
                    questions = [
                        ...music.slice(0, half).map(q => ({ ...q, type: 'qcm' })),
                        ...music.slice(half, numQ).map(q => ({ ...q, type: 'writing' }))
                    ];
                } else {
                    questions = music.slice(0, numQ).map(q => ({ ...q, type: mode }));
                }

                const newRoom = {
                    code,
                    host: name,
                    players: [{ name, score: 0 }],
                    questions,
                    currentQ: 0,
                    started: false
                };
                
                db.ref(`rooms/${code}`).set(newRoom);
                setRoom(newRoom);
                setPlayerIdx(0);
                setIsHost(true);
                setScreen('lobby');
            };

            const join = (name, code) => {
                db.ref(`rooms/${code}`).once('value', snapshot => {
                    const existing = snapshot.val();
                    if (!existing) { alert('‚ùå Code invalide'); return; }
                    if (existing.started) { alert('‚ùå D√©j√† lanc√©e'); return; }

                    existing.players.push({ name, score: 0 });
                    db.ref(`rooms/${code}`).update({ players: existing.players });
                    
                    setRoom(existing);
                    setPlayerIdx(existing.players.length - 1);
                    setIsHost(false);
                    setScreen('lobby');
                });
            };

            const start = () => {
                db.ref(`rooms/${room.code}`).update({ started: true });
            };

            const answer = (pts) => {
                const updatedPlayers = [...room.players];
                updatedPlayers[playerIdx].score = (updatedPlayers[playerIdx].score || 0) + pts;
                
                // ATTENDRE QUE TOUT LE MONDE AIT R√âPONDU (20s max)
                setTimeout(() => {
                    db.ref(`rooms/${room.code}`).update({
                        players: updatedPlayers,
                        currentQ: room.currentQ + 1
                    });
                }, 20000); // 20 secondes
            };

            const restart = () => {
                if (roomRef.current) roomRef.current.off();
                setScreen('menu');
                setRoom(null);
            };

            return (
                <div className="app">
                    <div className="bg"></div>
                    {screen === 'menu' && <Menu onCreate={() => setScreen('create')} onJoin={() => setScreen('join')} />}
                    {screen === 'create' && <Create onStart={create} />}
                    {screen === 'join' && <Join onJoin={join} />}
                    {screen === 'lobby' && room && <Lobby room={room} isHost={isHost} onStart={start} />}
                    {screen === 'game' && room && <Game room={room} playerIdx={playerIdx} onAnswer={answer} isHost={isHost} />}
                    {screen === 'leaderboard' && <Leaderboard room={room} onRestart={restart} />}
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Montserrat', sans-serif;
            background: #0a0e27;
            color: white;
        }
        .app { min-height: 100vh; position: relative; }
        .bg {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(255, 0, 110, 0.1), transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(131, 56, 236, 0.1), transparent 50%);
            animation: pulse 8s infinite;
            z-index: 0;
        }
        @keyframes pulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 0.8; }
        }
        .screen {
            position: relative;
            z-index: 1;
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .screen.game { justify-content: flex-start; padding-top: 1rem; }
        .logo { text-align: center; margin-bottom: 2rem; }
        .title {
            font-family: 'Bungee Shade', cursive;
            font-size: 4rem;
            background: linear-gradient(45deg, #ff006e, #00f5ff, #ffbe0b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .subtitle { font-size: 1.2rem; color: #00f5ff; letter-spacing: 0.2em; margin-top: 0.5rem; }
        .menu-btns { display: flex; flex-direction: column; gap: 1rem; width: 100%; max-width: 400px; }
        .btn {
            background: linear-gradient(135deg, #ff006e, #8338ec);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            font-size: 1rem;
            font-weight: 800;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Montserrat', sans-serif;
            margin: 0.3rem;
        }
        .btn:hover:not(:disabled) { transform: translateY(-3px); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .btn.secondary { background: linear-gradient(135deg, #00f5ff, #ffbe0b); }
        .btn.large { padding: 1.5rem 3rem; font-size: 1.3rem; margin-top: 2rem; }
        .screen-title { font-size: 2.5rem; font-weight: 800; color: #ffbe0b; margin-bottom: 2rem; }
        .input, .select {
            width: 100%;
            max-width: 400px;
            padding: 1rem;
            margin: 0.5rem 0;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid #8338ec;
            border-radius: 10px;
            color: white;
            font-size: 1rem;
            font-family: 'Montserrat', sans-serif;
        }
        .input:focus, .select:focus { outline: none; border-color: #ff006e; }
        .code-input { font-size: 2rem; text-align: center; letter-spacing: 0.5em; }
        .section { margin: 1.5rem 0; text-align: center; }
        .section h3 { color: #00f5ff; margin-bottom: 1rem; }
        .num-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 0.5rem; max-width: 400px; }
        .num-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid #8338ec;
            color: white;
            padding: 0.8rem;
            font-size: 1.1rem;
            font-weight: 800;
            border-radius: 10px;
            cursor: pointer;
            font-family: 'Montserrat', sans-serif;
        }
        .num-btn.active { background: linear-gradient(135deg, #ff006e, #8338ec); border-color: #ff006e; }
        .code-display {
            text-align: center;
            background: linear-gradient(135deg, #1a1f3a, #2a2f4a);
            border: 3px solid #ffbe0b;
            border-radius: 25px;
            padding: 2rem;
            margin-bottom: 2rem;
        }
        .code-label { color: #aaa; font-size: 1rem; margin-bottom: 1rem; }
        .code-value {
            font-size: 5rem;
            font-weight: 800;
            color: #ffbe0b;
            letter-spacing: 0.3em;
            text-shadow: 0 0 30px rgba(255, 190, 11, 0.6);
        }
        .players-box {
            background: #1a1f3a;
            border: 2px solid #8338ec;
            border-radius: 20px;
            padding: 2rem;
            width: 100%;
            max-width: 600px;
            margin-bottom: 2rem;
        }
        .players-box h3 { color: #00f5ff; margin-bottom: 1rem; }
        .player {
            background: rgba(0, 0, 0, 0.3);
            padding: 1rem;
            border-radius: 10px;
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 0.5rem;
        }
        .player-num {
            background: #8338ec;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
        }
        .player-name { flex: 1; font-weight: 600; }
        .waiting { text-align: center; margin-top: 2rem; }
        .waiting p { font-size: 1.2rem; color: #ffbe0b; margin-top: 1rem; }
        .spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(255, 255, 255, 0.1);
            border-top-color: #ff006e;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .game-header {
            display: flex;
            justify-content: space-between;
            width: 100%;
            max-width: 800px;
            margin-bottom: 1.5rem;
            background: #1a1f3a;
            padding: 1rem 1.5rem;
            border-radius: 15px;
            border: 2px solid #8338ec;
            font-weight: 800;
        }
        .timer { color: #ff006e; font-size: 1.3rem; }
        .score { color: #ffbe0b; font-size: 1.3rem; }
        .img-box {
            width: 100%;
            max-width: 400px;
            margin: 0 auto 1.5rem;
            border-radius: 20px;
            overflow: hidden;
        }
        .cover {
            width: 100%;
            height: 400px;
            object-fit: cover;
            transition: filter 0.3s ease;
        }
        .audio-box { text-align: center; margin: 1rem 0; }
        .audio-btn {
            background: linear-gradient(135deg, #ffbe0b, #ff006e);
            color: white;
            border: none;
            padding: 0.8rem 2rem;
            font-size: 1rem;
            font-weight: 800;
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Montserrat', sans-serif;
        }
        .question-box { width: 100%; max-width: 600px; margin: 0 auto; }
        .q-text {
            text-align: center;
            font-size: 1.5rem;
            font-weight: 800;
            color: #00f5ff;
            margin-bottom: 1.5rem;
        }
        .options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        .opt {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid #8338ec;
            padding: 1.5rem;
            border-radius: 15px;
            color: white;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            transition: all 0.3s;
        }
        .opt:hover:not(:disabled) { background: rgba(131, 56, 236, 0.2); transform: scale(1.05); }
        .opt.correct { background: rgba(0, 255, 100, 0.2); border-color: #00ff64; }
        .opt.wrong { background: rgba(255, 0, 0, 0.2); border-color: #ff0033; }
        .result {
            margin-top: 1.5rem;
            padding: 1.5rem;
            border-radius: 15px;
            text-align: center;
            font-size: 1.3rem;
            font-weight: 800;
        }
        .result.correct { background: rgba(0, 255, 100, 0.2); border: 2px solid #00ff64; color: #00ff64; }
        .result.wrong { background: rgba(255, 0, 0, 0.2); border: 2px solid #ff0033; color: #ff6b6b; }
        .leaderboard-screen { min-height: 100vh; }
        .leaderboard-title {
            font-size: 3rem;
            font-weight: 800;
            color: #ffbe0b;
            margin-bottom: 2rem;
            text-shadow: 0 0 20px rgba(255, 190, 11, 0.5);
        }
        .podium {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin: 2rem 0;
            flex-wrap: wrap;
        }
        .podium-item {
            background: #1a1f3a;
            border: 3px solid #8338ec;
            border-radius: 20px;
            padding: 2rem 1.5rem;
            text-align: center;
            min-width: 150px;
        }
        .medal { font-size: 3rem; margin-bottom: 0.5rem; }
        .p-name { font-weight: 800; font-size: 1.2rem; color: #ffbe0b; margin-bottom: 0.5rem; }
        .p-score { font-size: 1.5rem; font-weight: 800; color: #ff006e; }
        .leaderboard {
            background: #1a1f3a;
            border: 2px solid #8338ec;
            border-radius: 20px;
            padding: 1.5rem;
            width: 100%;
            max-width: 600px;
            margin: 2rem 0;
        }
        .lb-row {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            margin-bottom: 0.5rem;
        }
        .rank {
            background: #8338ec;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
        }
        .name { flex: 1; font-weight: 600; }
        .pts { font-weight: 800; color: #ffbe0b; font-size: 1.2rem; }
        @media (max-width: 768px) {
            .title { font-size: 2.5rem; }
            .options { grid-template-columns: 1fr; }
            .cover { height: 300px; }
            .code-value { font-size: 3rem; }
        }
    </style>
</body>
</html>
