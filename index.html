<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Party üéµ</title>
    <link href="https://fonts.googleapis.com/css2?family=Bungee+Shade&family=Montserrat:wght@600;800&display=swap" rel="stylesheet">
</head>
<body>
    <div id="root"></div>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <!-- React -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // FIREBASE CONFIG
        const firebaseConfig = {
            apiKey: "AIzaSyAWA-Zfs_hljCFz1wc0Rg2LJWZPINWONnU",
            authDomain: "quizz-party-ptg.firebaseapp.com",
            databaseURL: "https://quizz-party-ptg-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "quizz-party-ptg",
            storageBucket: "quizz-party-ptg.firebasestorage.app",
            messagingSenderId: "352511986737",
            appId: "1:352511986737:web:7318d807b4d3f3b6b29910"
        };

        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // DEEZER API
        class DeezerAPI {
            constructor() {
                this.proxies = ['', 'https://corsproxy.io/?', 'https://api.codetabs.com/v1/proxy?quest='];
            }

            async fetchWithProxy(url) {
                for (let i = 0; i < this.proxies.length; i++) {
                    try {
                        const finalUrl = this.proxies[i] + encodeURIComponent(url);
                        const response = await fetch(finalUrl);
                        if (!response.ok) throw new Error('Erreur');
                        return await response.json();
                    } catch (error) {
                        if (i === this.proxies.length - 1) throw error;
                    }
                }
            }

            async getChart() {
                const data = await this.fetchWithProxy('https://api.deezer.com/chart/0/tracks?limit=50');
                return data.data.map(t => ({
                    title: t.title,
                    artist: t.artist.name,
                    cover: t.album.cover_big || 'https://via.placeholder.com/400',
                    preview: t.preview
                })).filter(t => t.preview);
            }

            async getPlaylist(id) {
                const data = await this.fetchWithProxy(`https://api.deezer.com/playlist/${id}`);
                return data.tracks.data.map(t => ({
                    title: t.title,
                    artist: t.artist.name,
                    cover: t.album.cover_big || 'https://via.placeholder.com/400',
                    preview: t.preview
                })).filter(t => t.preview);
            }
        }

        // UTILS
        const shuffle = arr => [...arr].sort(() => Math.random() - 0.5);
        const genCode = () => Math.floor(100000 + Math.random() * 900000).toString();

        // MENU
        const Menu = ({ onCreateParty, onJoinParty }) => (
            <div className="screen">
                <h1 className="title">QUIZ PARTY</h1>
                <p className="subtitle">üéµ Blind Test Musical</p>
                <div className="menu-buttons">
                    <button className="btn large" onClick={onCreateParty}>
                        üéÆ Cr√©er une partie
                    </button>
                    <button className="btn large secondary" onClick={onJoinParty}>
                        üë• Rejoindre une partie
                    </button>
                </div>
            </div>
        );

        // CR√âATION
        const CreateScreen = ({ onStart }) => {
            const [deezer] = useState(new DeezerAPI());
            const [name, setName] = useState('');
            const [playlist, setPlaylist] = useState('');
            const [numQ, setNumQ] = useState(10);
            const [mode, setMode] = useState('qcm');
            const [loading, setLoading] = useState(false);

            const loadTop50 = async () => {
                if (!name) { alert('‚ö†Ô∏è Entre ton pseudo !'); return; }
                setLoading(true);
                try {
                    const tracks = await deezer.getChart();
                    alert(`‚úÖ ${tracks.length} morceaux !`);
                    onStart(name, mode, numQ, tracks);
                } catch (e) {
                    alert('‚ùå Erreur: ' + e.message);
                }
                setLoading(false);
            };

            const loadPlaylist = async () => {
                if (!name) { alert('‚ö†Ô∏è Entre ton pseudo !'); return; }
                const match = playlist.match(/playlist\/(\d+)/);
                if (!match) { alert('‚ùå URL invalide'); return; }
                
                setLoading(true);
                try {
                    const tracks = await deezer.getPlaylist(match[1]);
                    alert(`‚úÖ ${tracks.length} morceaux !`);
                    onStart(name, mode, numQ, tracks);
                } catch (e) {
                    alert('‚ùå Erreur: ' + e.message);
                }
                setLoading(false);
            };

            return (
                <div className="screen">
                    <h2>üéÆ Cr√©er une partie</h2>
                    
                    <input 
                        className="input" 
                        placeholder="Ton pseudo" 
                        value={name}
                        onChange={e => setName(e.target.value)}
                        maxLength={20}
                    />

                    <div className="section">
                        <h3>üéØ Mode</h3>
                        <select className="select" value={mode} onChange={e => setMode(e.target.value)}>
                            <option value="qcm">QCM</option>
                            <option value="writing">√âcriture</option>
                            <option value="soiree">Soir√©e</option>
                        </select>
                    </div>

                    <div className="section">
                        <h3>üî¢ Questions</h3>
                        <div className="num-grid">
                            {[5,10,15,20,30].map(n => (
                                <button 
                                    key={n}
                                    className={`num-btn ${numQ === n ? 'active' : ''}`}
                                    onClick={() => setNumQ(n)}
                                >
                                    {n}
                                </button>
                            ))}
                        </div>
                    </div>

                    <div className="section">
                        <h3>üéµ Musique</h3>
                        <button className="btn" onClick={loadTop50} disabled={loading}>
                            {loading ? '‚è≥' : 'üî•'} Top 50
                        </button>
                        <input 
                            className="input" 
                            placeholder="URL Playlist Deezer"
                            value={playlist}
                            onChange={e => setPlaylist(e.target.value)}
                        />
                        <button className="btn" onClick={loadPlaylist} disabled={!playlist || loading}>
                            {loading ? '‚è≥' : 'üìã'} Charger
                        </button>
                    </div>
                </div>
            );
        };

        // REJOINDRE
        const JoinScreen = ({ onJoin }) => {
            const [name, setName] = useState('');
            const [code, setCode] = useState('');

            return (
                <div className="screen">
                    <h2>üë• Rejoindre</h2>
                    <input 
                        className="input" 
                        placeholder="Ton pseudo"
                        value={name}
                        onChange={e => setName(e.target.value)}
                        maxLength={20}
                    />
                    <input 
                        className="input code-input" 
                        placeholder="123456"
                        type="tel"
                        value={code}
                        onChange={e => setCode(e.target.value.replace(/\D/g, ''))}
                        maxLength={6}
                    />
                    <button 
                        className="btn large"
                        onClick={() => onJoin(name, code)}
                        disabled={!name || code.length !== 6}
                    >
                        ‚ñ∂Ô∏è Rejoindre
                    </button>
                </div>
            );
        };

        // LOBBY
        const Lobby = ({ room, isHost, onStart }) => (
            <div className="screen">
                <h2>Salle d'attente</h2>
                <div className="code-box">
                    <div className="code-label">Code</div>
                    <div className="code-big">{room.code}</div>
                </div>
                <div className="players">
                    <h3>üë• Joueurs ({room.players?.length || 0})</h3>
                    {room.players?.map((p, i) => (
                        <div key={i} className="player">
                            <span>#{i+1}</span>
                            <span>{p.name}</span>
                            {p.name === room.host && <span>üëë</span>}
                        </div>
                    ))}
                </div>
                {isHost && <button className="btn large" onClick={onStart}>‚ñ∂Ô∏è Lancer</button>}
                {!isHost && <p className="waiting">‚è≥ En attente...</p>}
            </div>
        );

        // JEU
        const Game = ({ room, playerIdx, onAnswer, musicDB }) => {
            const [time, setTime] = useState(20);
            const [answered, setAnswered] = useState(false);
            const [options, setOptions] = useState([]);
            const [correct, setCorrect] = useState('');
            const [qText, setQText] = useState('');
            const [inputs, setInputs] = useState({ title: '', artist: '' });
            const [result, setResult] = useState(null);

            const audioRef = useRef(null);
            const timerRef = useRef(null);
            const submitRef = useRef(false);
            
            const q = room.questions[room.currentQ];
            const player = room.players[playerIdx];
            const blur = answered ? 0 : (time / 20) * 25;

            useEffect(() => {
                setTime(20);
                setAnswered(false);
                setResult(null);
                setInputs({ title: '', artist: '' });
                submitRef.current = false;

                if (audioRef.current) {
                    audioRef.current.pause();
                    audioRef.current.currentTime = 0;
                    setTimeout(() => audioRef.current?.play().catch(() => {}), 200);
                }

                if (q.type === 'qcm') {
                    const type = Math.random() > 0.5 ? 'artist' : 'title';
                    const correctAns = q[type];
                    const opts = [correctAns];
                    const pool = shuffle(musicDB.filter(m => m[type] !== correctAns));
                    
                    while (opts.length < 4 && pool.length > 0) {
                        const val = pool.pop()[type];
                        if (!opts.includes(val)) opts.push(val);
                    }

                    setOptions(shuffle(opts));
                    setCorrect(correctAns);
                    setQText(type === 'artist' ? "Qui est l'artiste ?" : "Quel est le titre ?");
                }

                timerRef.current = setInterval(() => {
                    setTime(prev => {
                        if (prev <= 1) {
                            clearInterval(timerRef.current);
                            if (!submitRef.current) {
                                submitRef.current = true;
                                handleSubmit(null, 0);
                            }
                            return 0;
                        }
                        return prev - 1;
                    });
                }, 1000);

                return () => {
                    clearInterval(timerRef.current);
                    if (audioRef.current) audioRef.current.pause();
                };
            }, [room.currentQ]);

            const handleSubmit = (answer, t = time) => {
                if (answered) return;
                setAnswered(true);
                clearInterval(timerRef.current);
                if (audioRef.current) audioRef.current.pause();

                let isCorrect = false;
                let pts = 0;
                let msg = '';

                if (q.type === 'qcm') {
                    isCorrect = answer === correct;
                    pts = isCorrect ? (50 + t * 10) : 0;
                    msg = isCorrect ? `üéâ +${pts} pts !` : `‚ùå ${q.title} - ${q.artist}`;
                } else {
                    const title = inputs.title.toLowerCase().trim();
                    const artist = inputs.artist.toLowerCase().trim();
                    const titleOk = title && q.title.toLowerCase().includes(title.split(' ')[0]);
                    const artistOk = artist && q.artist.toLowerCase().includes(artist.split(' ')[0]);
                    
                    if (titleOk && artistOk) {
                        isCorrect = true;
                        pts = 50 + t * 10;
                        msg = `üéâ +${pts} pts`;
                    } else if (titleOk || artistOk) {
                        isCorrect = true;
                        pts = Math.floor((50 + t * 10) * 0.5);
                        msg = `üëç +${pts} pts (50%)`;
                    } else {
                        msg = `‚ùå ${q.title} - ${q.artist}`;
                    }
                }

                setResult({ isCorrect, msg });
                setTimeout(() => onAnswer(pts), 2500);
            };

            return (
                <div className="screen game">
                    <div className="game-header">
                        <div>‚è±Ô∏è {time}s</div>
                        <div>Q {room.currentQ + 1}/{room.questions.length}</div>
                        <div>üèÜ {player.score}</div>
                    </div>

                    <img src={q.cover} className="cover" style={{ filter: `blur(${blur}px)` }} />

                    <audio ref={audioRef} src={q.preview} loop />
                    <button className="audio-btn" onClick={() => {
                        if (audioRef.current?.paused) audioRef.current.play();
                        else audioRef.current?.pause();
                    }}>
                        üéµ {answered ? 'Stop' : 'Play'}
                    </button>

                    <div className="question">
                        {q.type === 'qcm' && (
                            <>
                                <h3>{qText}</h3>
                                <div className="options">
                                    {options.map((opt, i) => (
                                        <button
                                            key={i}
                                            className={`opt ${result ? (opt === correct ? 'correct' : 'wrong') : ''}`}
                                            onClick={() => handleSubmit(opt, time)}
                                            disabled={answered}
                                        >
                                            {opt}
                                        </button>
                                    ))}
                                </div>
                            </>
                        )}

                        {q.type === 'writing' && (
                            <>
                                <h3>√âcris le titre et l'artiste</h3>
                                <input
                                    className="input"
                                    placeholder="Titre"
                                    value={inputs.title}
                                    onChange={e => setInputs({...inputs, title: e.target.value})}
                                    disabled={answered}
                                />
                                <input
                                    className="input"
                                    placeholder="Artiste"
                                    value={inputs.artist}
                                    onChange={e => setInputs({...inputs, artist: e.target.value})}
                                    disabled={answered}
                                />
                                {!answered && <button className="btn" onClick={() => handleSubmit(null, time)}>Valider</button>}
                            </>
                        )}

                        {result && (
                            <div className={`result ${result.isCorrect ? 'correct' : 'wrong'}`}>
                                {result.msg}
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        // LEADERBOARD
        const Leaderboard = ({ room, onRestart }) => {
            if (!room?.players) {
                return (
                    <div className="screen">
                        <h2>Chargement...</h2>
                        <button className="btn large" onClick={onRestart}>üè† Menu</button>
                    </div>
                );
            }

            const sorted = [...room.players].sort((a, b) => b.score - a.score);

            return (
                <div className="screen">
                    <h1 className="leaderboard-title">üèÜ CLASSEMENT üèÜ</h1>
                    
                    <div className="podium">
                        {sorted.slice(0, 3).map((p, i) => (
                            <div key={i} className="podium-item">
                                <div className="medal">{['ü•á','ü•à','ü•â'][i]}</div>
                                <div className="p-name">{p.name}</div>
                                <div className="p-score">{p.score} pts</div>
                            </div>
                        ))}
                    </div>

                    <div className="ranks">
                        {sorted.map((p, i) => (
                            <div key={i} className="rank-row">
                                <span className="rank-num">#{i+1}</span>
                                <span className="rank-name">{p.name}</span>
                                <span className="rank-score">{p.score} pts</span>
                            </div>
                        ))}
                    </div>

                    <button className="btn large" onClick={onRestart}>üè† Menu</button>
                </div>
            );
        };

        // APP
        const App = () => {
            const [screen, setScreen] = useState('menu');
            const [room, setRoom] = useState(null);
            const [playerIdx, setPlayerIdx] = useState(0);
            const [isHost, setIsHost] = useState(false);
            const [musicDB, setMusicDB] = useState([]);

            const roomRef = useRef(null);

            useEffect(() => {
                if (room?.code) {
                    const ref = database.ref(`rooms/${room.code}`);
                    roomRef.current = ref;

                    ref.on('value', snapshot => {
                        const data = snapshot.val();
                        if (data) {
                            setRoom(data);
                            
                            if (data.started && screen === 'lobby') {
                                setScreen('game');
                            }
                            
                            if (data.currentQ >= data.questions.length && screen === 'game') {
                                setTimeout(() => setScreen('leaderboard'), 1500);
                            }
                        }
                    });

                    return () => ref.off();
                }
            }, [room?.code, screen]);

            const createParty = (name, mode, numQ, tracks) => {
                const code = genCode();
                setMusicDB(tracks);
                
                const music = shuffle(tracks);
                let questions;
                
                if (mode === 'soiree') {
                    const half = Math.floor(numQ / 2);
                    questions = [
                        ...music.slice(0, half).map(q => ({ ...q, type: 'qcm' })),
                        ...music.slice(half, numQ).map(q => ({ ...q, type: 'writing' }))
                    ];
                } else {
                    questions = music.slice(0, numQ).map(q => ({ ...q, type: mode }));
                }

                const newRoom = {
                    code,
                    host: name,
                    players: [{ name, score: 0 }],
                    questions,
                    currentQ: 0,
                    started: false
                };
                
                database.ref(`rooms/${code}`).set(newRoom);
                setRoom(newRoom);
                setPlayerIdx(0);
                setIsHost(true);
                setScreen('lobby');
            };

            const joinParty = (name, code) => {
                database.ref(`rooms/${code}`).once('value', snapshot => {
                    const existing = snapshot.val();
                    if (!existing) { 
                        alert('‚ùå Code invalide'); 
                        return; 
                    }
                    if (existing.started) { 
                        alert('‚ùå D√©j√† lanc√©e'); 
                        return; 
                    }

                    const newPlayer = { name, score: 0 };
                    existing.players.push(newPlayer);
                    
                    database.ref(`rooms/${code}`).update({ players: existing.players });
                    
                    setRoom(existing);
                    setPlayerIdx(existing.players.length - 1);
                    setIsHost(false);
                    setMusicDB(existing.questions);
                    setScreen('lobby');
                });
            };

            const startGame = () => {
                database.ref(`rooms/${room.code}`).update({ started: true });
            };

            const handleAnswer = (pts) => {
                const updatedPlayers = [...room.players];
                updatedPlayers[playerIdx].score += pts;
                
                database.ref(`rooms/${room.code}`).update({
                    players: updatedPlayers,
                    currentQ: room.currentQ + 1
                });
            };

            const restart = () => {
                if (roomRef.current) roomRef.current.off();
                setScreen('menu');
                setRoom(null);
                setMusicDB([]);
            };

            return (
                <div className="app">
                    {screen === 'menu' && <Menu onCreateParty={() => setScreen('create')} onJoinParty={() => setScreen('join')} />}
                    {screen === 'create' && <CreateScreen onStart={createParty} />}
                    {screen === 'join' && <JoinScreen onJoin={joinParty} />}
                    {screen === 'lobby' && room && <Lobby room={room} isHost={isHost} onStart={startGame} />}
                    {screen === 'game' && room && <Game room={room} playerIdx={playerIdx} onAnswer={handleAnswer} musicDB={musicDB} />}
                    {screen === 'leaderboard' && room && <Leaderboard room={room} onRestart={restart} />}
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }

        .app { min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 1rem; }
        
        .screen {
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            max-width: 600px;
            width: 100%;
            text-align: center;
        }

        .screen.game { max-width: 800px; }

        .title {
            font-family: 'Bungee Shade', cursive;
            font-size: 3rem;
            margin-bottom: 0.5rem;
        }

        .subtitle { font-size: 1.2rem; opacity: 0.8; margin-bottom: 2rem; }

        .menu-buttons { display: flex; flex-direction: column; gap: 1rem; }

        .btn {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border: none;
            padding: 1rem 2rem;
            border-radius: 50px;
            color: white;
            font-weight: 800;
            font-size: 1rem;
            cursor: pointer;
            transition: transform 0.2s;
            font-family: 'Montserrat', sans-serif;
        }

        .btn:hover:not(:disabled) { transform: translateY(-3px); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .btn.large { padding: 1.5rem 3rem; font-size: 1.2rem; margin: 0.5rem 0; }
        .btn.secondary { background: linear-gradient(135deg, #00f5ff 0%, #667eea 100%); }

        .input, .select {
            width: 100%;
            padding: 1rem;
            margin: 0.5rem 0;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            color: white;
            font-size: 1rem;
            font-family: 'Montserrat', sans-serif;
        }

        .input::placeholder { color: rgba(255, 255, 255, 0.5); }
        .input:focus, .select:focus { outline: none; border-color: #f5576c; }
        .code-input { font-size: 2rem; text-align: center; letter-spacing: 0.5em; }

        .section { margin: 1.5rem 0; }
        .section h3 { margin-bottom: 1rem; font-size: 1.2rem; }

        .num-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 0.5rem;
        }

        .num-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 0.8rem;
            border-radius: 10px;
            color: white;
            font-weight: 800;
            cursor: pointer;
            font-family: 'Montserrat', sans-serif;
            transition: all 0.2s;
        }

        .num-btn:hover { background: rgba(255, 255, 255, 0.2); }
        .num-btn.active {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-color: #f5576c;
        }

        .code-box {
            background: rgba(255, 255, 255, 0.1);
            padding: 2rem;
            border-radius: 15px;
            margin: 2rem 0;
        }

        .code-label { opacity: 0.7; margin-bottom: 0.5rem; }
        .code-big { font-size: 3rem; font-weight: 800; letter-spacing: 0.2em; }

        .players {
            background: rgba(0, 0, 0, 0.2);
            padding: 1.5rem;
            border-radius: 15px;
            margin: 2rem 0;
        }

        .player {
            display: flex;
            justify-content: space-between;
            padding: 0.8rem;
            margin: 0.5rem 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        .waiting { font-size: 1.2rem; margin-top: 2rem; opacity: 0.8; }

        .game-header {
            display: flex;
            justify-content: space-between;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            margin-bottom: 1rem;
            font-weight: 800;
            font-size: 1.1rem;
        }

        .cover {
            width: 100%;
            max-width: 400px;
            height: 400px;
            object-fit: cover;
            border-radius: 15px;
            margin: 1rem 0;
            transition: filter 0.3s;
        }

        .audio-btn {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            border: none;
            padding: 1rem 2rem;
            border-radius: 50px;
            color: white;
            font-weight: 800;
            cursor: pointer;
            margin: 1rem 0;
            font-family: 'Montserrat', sans-serif;
        }

        .question { margin-top: 2rem; }
        .question h3 { margin-bottom: 1.5rem; font-size: 1.3rem; }

        .options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .opt {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 1.5rem;
            border-radius: 10px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'Montserrat', sans-serif;
        }

        .opt:hover:not(:disabled) { transform: scale(1.05); background: rgba(255, 255, 255, 0.2); }
        .opt.correct { background: rgba(0, 255, 0, 0.3); border-color: #00ff00; }
        .opt.wrong { background: rgba(255, 0, 0, 0.3); border-color: #ff0000; }

        .result {
            margin-top: 1.5rem;
            padding: 1.5rem;
            border-radius: 10px;
            font-size: 1.2rem;
            font-weight: 800;
        }

        .result.correct { background: rgba(0, 255, 0, 0.3); border: 2px solid #00ff00; }
        .result.wrong { background: rgba(255, 0, 0, 0.3); border: 2px solid #ff0000; }

        .leaderboard-title {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 2rem;
            color: #fee140;
        }

        .podium {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin: 2rem 0;
            flex-wrap: wrap;
        }

        .podium-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 1.5rem;
            border-radius: 15px;
            min-width: 120px;
        }

        .medal { font-size: 3rem; margin-bottom: 0.5rem; }
        .p-name { font-weight: 800; margin: 0.5rem 0; }
        .p-score { font-size: 1.5rem; color: #fee140; font-weight: 800; }

        .ranks {
            background: rgba(0, 0, 0, 0.2);
            padding: 1.5rem;
            border-radius: 15px;
            margin: 2rem 0;
        }

        .rank-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.8rem;
            margin: 0.5rem 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        .rank-num { font-weight: 800; }
        .rank-name { flex: 1; text-align: center; }
        .rank-score { font-weight: 800; color: #fee140; }

        @media (max-width: 768px) {
            .title { font-size: 2rem; }
            .options { grid-template-columns: 1fr; }
            .cover { height: 300px; }
            .code-big { font-size: 2rem; }
        }
    </style>
</body>
</html>
